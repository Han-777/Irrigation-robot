# 整体方案

## Main 主机 (STM32H743XIH6)

[H743教程]([【学以致用，授人以渔】2024视频教程汇总，DSP第12期，ThreadX第9期，BSP驱动第30期，USB实战第5期，GUI实战第3期（2024-04-30） - STM32F429 - 硬汉嵌入式论坛 - Powered by Discuz! (armbbs.cn)](https://www.armbbs.cn/forum.php?mod=viewthread&tid=110519))

### 反客卡发板资源

A <u>0 1 2 3 4 5</u> 6 <u>7 8 9 10</u> （带下划线为**未作为其他外设**引脚使用）

特殊引脚 A0_C  A1_C C2_C C3_C ( Direct channels are connected to analog I/Os (PA0_C, PA1_C, PC2_C and PC3_C) to optimize ADC performance.)

B <u>0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15</u> 

C <u>1 2 3 4 5 6 7</u> 8 9 10 11 12 

D 2 <u>3 4 5 6 7 11 12 13</u> 

E <u>2 3 4 5 6</u>

G <u>9 11 12 13 14</u> 

H <u>7</u> 8 9 10 11 12 13 14 

I <u>0 1 2 3</u> 4 5 6 7 8 9





【

A <u>**0 1** **2 3** **4 5**</u> **6** <u>**7** **8** **9 10**</u> （带下划线为**未作为其他外设**引脚使用）

特殊引脚 A0_C  A1_C C2_C C3_C (ADC 引脚)

B <u>**0** **1** **2 3** **4** **5 6** **7** **8 9** **10 11** **12 13** **14 15**</u> 

C <u>**1 2 3 4 5** **6 7**</u> **8 9** **10 11** **12** 

D **2** <u>**3 4 5 6 7** **11 12 13**</u> 

E <u>**2 3 4 5 6**</u>

G <u>**9** **11 12 13** **14**</u> 

H **<u>7</u> 8 9 10 11** **12** **13 14** 

I **<u>0 1 2 3</u> 4 5 6 7** **8 9**



A6: TIM13_1 | A7 TIM14_1 | A8-A11 TIM1_1-4 | 

PB 2, 3, 14, 15 | PC 1, 2, 3, 4, 5 | PD3, 4, 5, 6, 7

PG 7,9,14 \| PA8,15 \| PB5,6,7\| PE5,6 \| PC0,9 \| PD4,7

### 串口引脚

|   USART   |      外设      |          TX          |        RX         |   备注   |
| :-------: | :------------: | :------------------: | :---------------: | :------: |
|    1_     |      蓝牙      |         PA9          |       PA10        |          |
|    2_     | TFmini激光雷达 |         PA2          |        PA3        |   left   |
|    3_     |     openmv     |   PB10 (I2C2_SCL)    |  PB11(I2C2_SDA)   |          |
|    4_     | TFmini激光雷达 | **PC10** \| H13(CAN) | PC11 \| H14 (CAN) |  right   |
|    5_     |   mpu陀螺仪    |         PC12         |        PD2        |          |
|    6_     |                |      C6/**G14**      |     C7/**G9**     |          |
| 虚拟串口_ |    MP3语音f    |     PD6->**I8**      |   PG15->**I9**    | 需要测试 |
|     7     |                |                      |                   |          |
|     8     |                |                      |                   |          |

### CAN

| CAN  | 外设 |              TX               |              RX               | 备注 |
| :--: | :--: | :---------------------------: | :---------------------------: | :--: |
| can2 |      |         B6(SCL) / B13         |           B5 / B12            |      |
| can1 |      | B9(I2C1_SDA) / H13 (UART4-TX) | B8(I2C1_SCL) / H14 (USAR4-RX) |      |

**TIM**

|      TIM       |                                                      |                                         |
| :------------: | :--------------------------------------------------: | :-------------------------------------: |
|     TIM1_      |                      A8(ch1) \|                      |             **高级定时器**              |
|      TIM2      |                       A5(ETR)                        |                                         |
|     TIM13_     |                       A6(ch1)                        |            **舵机1 (pitch)**            |
|     TIM14_     |                       A7(ch1)                        |            **舵机2（yaw）**             |
|     TIM5_      | A0(ch1) \| A1(ch2) \| A4(ETR) \| H12(CH3) \| I0(CH4) |                                         |
| TIM3 （0 1 4） |   **B4(CH1)** \| B5(CH2) \| B0(CH3) \| **B1(CH4)**   |                                         |
|   TIM4 （7）   |    B6(CH1) \| **B7(CH2)** \| D12(CH1) \| D13(CH2)    |                                         |
|     TIM12      |                 B14(CH1) \| B15(CH2)                 | 可以引出作为PWM引脚，同时给**灰度使用** |
|      TIM3      |                 C6(CH1) \| C7 (CH2)                  |                                         |
|      TIM8      | C6(CH1) \| C7 (CH2) \| C8(CH3) \| C9(CH4) \| I3(ETR) |             **高级定时器**              |
|     TIM15      |                  E5(CH1) \| E6(CH2)                  |                                         |



|   外设   |                             Pin                              |          备注           |
| :------: | :----------------------------------------------------------: | :---------------------: |
|   灰度   |    PB 2, 3, 14, 15 \| PC 1, 2, 3, 4, 5 \| PD3, 4, 5, 6, 7    |                         |
|   GPIO   | D11, 12, 13 \| E2, 3, 4 \| G11, 12, 13 \| H7, 8, 9, 10, 11, 13, 14 \| I1, 2, 4, 5, 6, 7 | H13和H14可能还用作UART4 |
|  光电L   |                              I3                              |          Left           |
|  光电R   |                              I4                              |          Right          |
| 光电喷头 |                              I5                              |          喷头           |
|   IIC    |               D12(I2C4_SCL) \| D13 (I2C4_SCL)                |      还用做普通io       |
|  继电器  |                              I6                              |                         |
|   水泵   |                              I7                              |                         |
|          |                                                              |                         |
|          |                                                              |                         |
|          |                                                              |                         |
|          |                                                              |                         |
|          |                                                              |                         |
|          |                                                              |                         |
|          |                                                              |                         |
|          |                                                              |                         |
|          |                                                              |                         |
| 继电器？ |                         PB12 \| PB4                          |        好像没有         |
|          |                                                              |                         |

![image-20240704195614283](C:\Users\blue\AppData\Roaming\Typora\typora-user-images\image-20240704195614283.png)

![image-20240704195632883](C:\Users\blue\AppData\Roaming\Typora\typora-user-images\image-20240704195632883.png)

![image-20240704195645945](C:\Users\blue\AppData\Roaming\Typora\typora-user-images\image-20240704195645945.png)

![image-20240704195706162](C:\Users\blue\AppData\Roaming\Typora\typora-user-images\image-20240704195706162.png)

![image-20240704195717271](C:\Users\blue\AppData\Roaming\Typora\typora-user-images\image-20240704195717271.png)







# 注意事项

### 1. 时间设置

HSE_STARTUP:系统启动时间改长： 5000UL

![image-20240705180852643](C:\Users\blue\AppData\Roaming\Typora\typora-user-images\image-20240705180852643.png)

# Freertos

## Heaps 堆

共享内存，在其上实现内存的分配与释放

malloc free new delete

## Stacks 栈 (the core of rtos)

the process of function call: 

* link register will store the address of function in stacks

* call the function

  

  



